<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
This is a skeleton html file that you can use to get you started on each new
HTML project

Name: Your Name Here
Class: CIS 3303
Section: x
-->

<html>

<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<body>

<p id="output1">[welcome message]</p>
Zip Code: <input type="text" id="myText" value="30092">
<button id="congressmenbutton" onclick="buttonHandler(this)">Congressmen</button> <button id="congressmenclear" onclick="buttonHandler(this)">Clear</button>
<p id="names"></p>

Bill Search: <input type="text" id="billsearchText" value = "">
<button id = "billsearchbutton" onclick="buttonHandler(this)">Search</button> <button id="billsearchclear" onclick="buttonHandler(this)">Clear</button>
<p id="billResults"></p>

<script>

document.getElementById('output1').innerHTML = "Welcome to the testing area for RepRec!";

function buttonHandler(button)
{
        if (button.id == "congressmenbutton")
        {
            document.getElementById('names').innerHTML = "";
            var zipcode = document.getElementById("myText").value;

            $.getJSON("http://congress.api.sunlightfoundation.com/legislators/locate?zip=" + zipcode + "&apikey=f7de381a2c9040249a24a93ce8b88c67", function(result){
                for (var i = 0; i < result.results.length; i++) {
                    document.getElementById('names').innerHTML =  (document.getElementById('names').innerHTML + result.results[i].first_name
                        + " " + result.results[i].last_name + "<br>");
                    document.getElementById('names').innerHTML =  (document.getElementById('names').innerHTML + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
                        + result.results[i].oc_email + "<br>");
                    document.getElementById('names').innerHTML =  (document.getElementById('names').innerHTML + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
                        + result.results[i].phone + "<br>");
                    document.getElementById('names').innerHTML =  (document.getElementById('names').innerHTML + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
                        + result.results[i].office + "<br>");
                }
            });
        }
        else if (button.id == "billsearchbutton")
        {
            document.getElementById('billResults').innerHTML = "";
            var searchText = document.getElementById("billsearchText").value;

            $.getJSON("http://congress.api.sunlightfoundation.com/bills?query=" + searchText + "&history.enacted=true&apikey=f7de381a2c9040249a24a93ce8b88c67", function(result){
                for (var i = 0; i < result.results.length; i++) {
                    if (result.results[i].short_title != null)
                    {
                        document.getElementById('billResults').innerHTML = (document.getElementById('billResults').innerHTML + "<a href = \"" + result.results[i].urls.congress
                            + "\">" + result.results[i].short_title + "</a> <br>");
                    }
                }
            });
        }
        else if (button.id == "congressmenclear")
        {
            document.getElementById('names').innerHTML = "";
        }
        else if (button.id == "billsearchclear")
        {
            document.getElementById('billResults').innerHTML = "";
        }
}

</script>

</body>
</html>
